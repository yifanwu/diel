
CREATE EVENT TABLE distanceRangeEvent (
  minDist int,
  maxDist int
);


create view currentRange as 
  select minDist, maxDist
  from LATEST distanceRangeEvent;

create event view currentRangeView AS
  select
    round(distance/1000)*1000,
    count() as c
  from flights
    group by round(distance/1000)*1000
  order by c
  limit 20;

create output rangeOutput AS
  select *
  from currentRangeView crv
  join currentRange cr on crv.request_timestep = cr.timestep;
